(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[229],{4875:function(e,t){var n;/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e.push(n);else if(Array.isArray(n)){if(n.length){var a=o.apply(null,n);a&&e.push(a)}}else if("object"===i){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var l in n)r.call(n,l)&&n[l]&&e.push(l)}}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0!==(n=(function(){return o}).apply(t,[]))&&(e.exports=n)}()},8078:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/home",function(){return n(8398)}])},8398:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var r=n(1287),o=n(1934),i=n.n(o),a=n(2167),l=n(6090),c=n(8063);let s=(0,c.Ue)(e=>{var t,n;return{windowWidth:null===(t=window)||void 0===t?void 0:t.innerWidth,windowHeight:null===(n=window)||void 0===n?void 0:n.innerHeight,wBlockCount:0,hBlockCount:0,setWindowSize:()=>e(()=>({windowWidth:window.innerWidth,windowHeight:window.innerHeight})),setWBlockCount:t=>e({wBlockCount:t}),setHBlockCount:t=>e({hBlockCount:t})}});var u=n(2699);let d=(0,c.Ue)((e,t)=>({updateTime:0,data:(()=>{if("undefined"==typeof localStorage)return{};let e=localStorage.getItem("pluginData");return e?JSON.parse(e):{}})(),readPluginConfig:()=>{fetch("./data/plugins.json").then(e=>e.json()).then(n=>{e((0,u.merge)(t(),n,{updateTime:new Date().getTime()}))})},setEnabled:(t,n)=>e(e=>({data:{...e.data,[t]:{...e.data[t],enabled:n}}})),updateConfig:t=>e(e=>{let n={...e.data,...t};return localStorage.setItem("pluginData",JSON.stringify(n)),{data:n}}),updatePluginConfig:(t,n)=>e(e=>{let r={...e.data,[t]:n};return localStorage.setItem("pluginData",JSON.stringify(r)),{data:r}})}));function f(e){var t;let n;let{cardInf:o,netRef:i,boardInfo:c}=e,[s,u]=(0,a.useState)(),f=(0,l.W)(),h=d(),{uiConfig:p,editing:v,registerI18n:g,updateCardPosition:m,t:w}=f,{data:y,updateTime:b}=h;(0,a.useEffect)(()=>(o.i18n&&g(o.i18n),o.register.install(y,u,f,h),o.register.render(p,w),console.log("Card ".concat(o.name," loaded.")),o.register.uninstall),[y,b]),(0,a.useEffect)(()=>{o.register.render(p,w)},[p.language]);let x=e=>{let t=Math.max(Math.round(e.clientX/p.blockSize),0),n=Math.max(Math.round(e.clientY/p.blockSize),0),r=o.position[p.rotation];t>=c.wBlockCount-r.w-1&&(t=c.wBlockCount-r.w),n>=c.hBlockCount-r.h-1&&(n=c.hBlockCount-r.h),m(o.name,p.rotation,{...r,x:t,y:n})},j=(n=null,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];n||(n=setTimeout(()=>{x.apply(this,t),n=null},100))}),S=e=>{v&&j(e)};if(null==i.current)return console.info("cannot find board ref, ignored"),(0,r.jsx)("div",{className:"error-card"});let k=o.position[p.rotation],C=k.x>-1?k.x:c.wBlockCount+k.x,E=k.y>-1?k.y:c.hBlockCount+k.y,O=i.current.querySelector("#net-".concat(C,"-").concat(E));if(null==O)return console.info("cannot find target start block, ignored"),(0,r.jsx)("div",{className:"error-card"});let N=O.getBoundingClientRect(),_=k.w>0?Math.min(C+k.w-1,c.wBlockCount-1):c.wBlockCount+k.w-1,B=k.h>0?Math.min(E+k.h-1,c.hBlockCount-1):c.hBlockCount+k.h-1,P=i.current.querySelector("#net-".concat(_,"-").concat(B));if(null==P)return console.info("cannot find target end block, ignored"),(0,r.jsx)("div",{className:"error-card"});let T=P.getBoundingClientRect(),D="card-".concat(o.name," card absolute ").concat((null===(t=o.style)||void 0===t?void 0:t.extraClass)||"");return(0,r.jsx)("div",{className:D,onDrag:S,style:{left:"".concat(null==N?void 0:N.left,"px"),top:"".concat(null==N?void 0:N.top,"px"),width:"".concat((null==T?void 0:T.right)-(null==N?void 0:N.left),"px"),height:"".concat((null==T?void 0:T.bottom)-(null==N?void 0:N.top),"px")},children:s})}var h=n(4875),p=n.n(h);let v={tab:{"h-12":!0,"cursor-pointer":!0},activeTab:{"h-12":!0,"cursor-pointer":!0,underline:!0,"underline-offset-2":!0}};var g=function(){let e=(0,l.W)(),t=d(),[n,o]=(0,a.useState)(0),i=function(n,r){"main"===r?e.setUIConfig(n):t.updatePluginConfig(r,n)},c=function(t,n){let o=Object.keys(t),a="flex flex-row p-2 items-center",l="bg-slate-700/80 rounded-md p-1 w-60",c=[];for(let s=0;s<o.length;++s){let u=o[s];switch(typeof t[u]){case"number":case"string":c.push((0,r.jsxs)("div",{className:a,children:[(0,r.jsxs)("label",{htmlFor:u,className:"px-2 w-44",children:[e.t(u),": "]}),(0,r.jsx)("input",{type:"text",name:u,value:t[u],className:l,onChange:e=>{t[u]=e.target.value,i(t,n)}})]},u));break;case"object":Object.keys(t[u]).forEach(o=>{let s="".concat(u,".").concat(o);c.push((0,r.jsxs)("div",{className:a,children:[(0,r.jsxs)("label",{htmlFor:s,className:"px-2 w-44",children:[e.t(s),": "]}),(0,r.jsx)("input",{type:"text",name:s,value:t[u][o],className:l,onChange:e=>{t[u][o]=e.target.value,i(t,n)}})]},s))})}}return c},s=["main",...Object.keys(t.data||{})],u=[];return s.forEach((n,r)=>{0===r?u.push(c(e.uiConfig,"main")):u.push(c(t.data[n],0===r?"main":n))}),(0,r.jsxs)("div",{className:"absolute z-10 w-10/12 h-5/6 rounded-xl bg-stone-700/70 flex flex-col items-center justify-center",children:[(0,r.jsxs)("div",{className:"flex flex-row items-center",children:[(0,r.jsx)("div",{className:"flex flex-col setting-tab flex-shrink-0 p-4",children:s.map((t,i)=>{let a=i===n?v.activeTab:v.tab;return(0,r.jsx)("div",{className:p()(a),onClick:()=>o(i),children:e.t(t)},t)})}),(0,r.jsx)("div",{className:"",children:u[n]})]}),(0,r.jsx)("div",{className:"flex flex-row items-center mt-4",children:(0,r.jsx)("div",{className:"px-6 py-2 bg-black/50 rounded-xl",onClick:()=>{e.setCurrentPage("home"),e.saveConfig()},children:"O K"})})]})};function m(){let{hBlockCount:e,wBlockCount:t,setHBlockCount:n,setWBlockCount:o}=s(),{currentPage:c,readConfig:u,setRotation:h}=(0,l.W)(),[p,v]=(0,a.useState)([]),[m,w]=(0,a.useState)([]),y=(0,a.useRef)(null),{data:b,readPluginConfig:x,updateConfig:j}=d();(0,a.useEffect)(()=>{u(),x();let e=()=>{let e=window.innerWidth-2*k.padding,t=window.innerHeight-2*k.padding;o(Math.floor(e/k.blockSize)),n(Math.floor(t/k.blockSize)),h(e>t?"landscape":"portrait")};return e(),window.addEventListener("resize",e),0===Object.keys(b).length&&fetch("./data/plugins.json").then(e=>e.json()).then(e=>j(e)),()=>{window.removeEventListener("resize",e)}},[]);let{cardInfos:S,uiConfig:k,initialized:C}=(0,l.W)();return(0,a.useEffect)(()=>{let n=[];for(let o=0;o<e;++o)for(let e=0;e<t;++e)n.push((0,r.jsx)("div",{id:"net-".concat(e,"-").concat(o)},o*t+e));v(n)},[e,t]),(0,a.useEffect)(()=>{w(Object.keys(S).map(n=>(0,r.jsx)(f,{cardInf:S[n],netRef:y,boardInfo:{wBlockCount:t,hBlockCount:e}},n)))},[p,S]),(0,r.jsxs)("main",{className:"flex min-h-screen h-full w-full p-24 bg-cover items-center justify-center relative",id:"main",style:{backgroundImage:"url(./".concat(k.bg,")")},children:[(0,r.jsx)(i(),{children:(0,r.jsx)("title",{children:"Summer Shadow"})}),(0,r.jsxs)("div",{className:"w-full h-full flex items-center justify-center absolute",style:{padding:"".concat(k.padding,"px")},children:[(0,r.jsx)("div",{id:"main-board",className:"grid w-full h-full [&>div]:border [&>div]:border-slate-400/60",ref:y,style:{gridTemplateColumns:"repeat(".concat(t,", 1fr)"),gridTemplateRows:"repeat(".concat(e,", 1fr)")},children:p}),"setting"===c&&(0,r.jsx)(g,{}),m]})]})}n(4383)},7143:function(e,t,n){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(2167),o=Symbol.for("react.element"),i=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,c={},s=null,u=null;for(r in void 0!==n&&(s=""+n),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,r)&&!l.hasOwnProperty(r)&&(c[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===c[r]&&(c[r]=t[r]);return{$$typeof:o,type:e,key:s,ref:u,props:c,_owner:a.current}}t.jsx=c,t.jsxs=c},1287:function(e,t,n){"use strict";e.exports=n(7143)},1934:function(e,t,n){e.exports=n(615)},8512:function(e,t,n){"use strict";n.d(t,{w_:function(){return c}});var r=n(2167),o={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},i=r.createContext&&r.createContext(o),a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},l=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)0>t.indexOf(r[o])&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n};function c(e){return function(t){return r.createElement(s,a({attr:a({},e.attr)},t),function e(t){return t&&t.map(function(t,n){return r.createElement(t.tag,a({key:n},t.attr),e(t.child))})}(e.child))}}function s(e){var t=function(t){var n,o=e.attr,i=e.size,c=e.title,s=l(e,["attr","size","title"]),u=i||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),r.createElement("svg",a({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,o,s,{className:n,style:a(a({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),c&&r.createElement("title",null,c),e.children)};return void 0!==i?r.createElement(i.Consumer,null,function(e){return t(e)}):t(o)}},2415:function(e,t,n){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(2167),o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=r.useState,a=r.useEffect,l=r.useLayoutEffect,c=r.useDebugValue;function s(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=i({inst:{value:n,getSnapshot:t}}),o=r[0].inst,u=r[1];return l(function(){o.value=n,o.getSnapshot=t,s(o)&&u({inst:o})},[e,n,t]),a(function(){return s(o)&&u({inst:o}),e(function(){s(o)&&u({inst:o})})},[e]),c(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},2179:function(e,t,n){"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(2167),o=n(4322),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=o.useSyncExternalStore,l=r.useRef,c=r.useEffect,s=r.useMemo,u=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var d=l(null);if(null===d.current){var f={hasValue:!1,value:null};d.current=f}else f=d.current;d=s(function(){function e(e){if(!c){if(c=!0,a=e,e=r(e),void 0!==o&&f.hasValue){var t=f.value;if(o(t,e))return l=t}return l=e}if(t=l,i(a,e))return t;var n=r(e);return void 0!==o&&o(t,n)?t:(a=e,l=n)}var a,l,c=!1,s=void 0===n?null:n;return[function(){return e(t())},null===s?void 0:function(){return e(s())}]},[t,n,r,o]);var h=a(e,d[0],d[1]);return c(function(){f.hasValue=!0,f.value=h},[h]),u(h),h}},4322:function(e,t,n){"use strict";e.exports=n(2415)},7231:function(e,t,n){"use strict";e.exports=n(2179)},8063:function(e,t,n){"use strict";n.d(t,{Ue:function(){return s}});let r=e=>{let t;let n=new Set,r=(e,r)=>{let o="function"==typeof e?e(t):e;if(!Object.is(o,t)){let e=t;t=(null!=r?r:"object"!=typeof o)?o:Object.assign({},t,o),n.forEach(n=>n(t,e))}},o=()=>t,i=e=>(n.add(e),()=>n.delete(e)),a=()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()},l={setState:r,getState:o,subscribe:i,destroy:a};return t=e(r,o,l),l},o=e=>e?r(e):r;var i=n(2167),a=n(7231);let{useSyncExternalStoreWithSelector:l}=a,c=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?o(e):e,n=(e,n)=>(function(e,t=e.getState,n){let r=l(e.subscribe,e.getState,e.getServerState||e.getState,t,n);return(0,i.useDebugValue)(r),r})(t,e,n);return Object.assign(n,t),n},s=e=>e?c(e):c}},function(e){e.O(0,[798,762,201,874,888,179],function(){return e(e.s=8078)}),_N_E=e.O()}]);